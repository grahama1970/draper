# Objective: Autonomous Hardware Exploit Evolution System

Develop an MCP-compatible, on-premises agentic R&D system (**draper-mcp-exploit-evolver**) for continuous, adaptive discovery and analysis of vulnerabilities in Draper's radiation-hardened microelectronics. The system automates exploit evolution using advanced genetic algorithms (GAs) guided by LoRA fine-tuning, integrates SEU-aware tiered evaluation, stores findings in a knowledge graph, provides cryptographic lineage proofs, and incorporates human oversight for critical decisions and patching.

---

# Core Components

- **Agentic Workflow (MCP):**  
  Orchestrated by `Boomerang`, coordinating specialized agents:  
  `Planner`, `RTLIntrospector`, `ExploitMutator`, `FormalSimRunner`, `CryptoProver`, `SecurityAnalyst`, `SeniorCoder-HW`, `Librarian-Formal-Verify`, `AutonomousFineTuner`.  
  Includes mandatory human-in-the-loop steps.

- **Exploit Mutator Engine:**  
  Advanced GA with hardware-specific mutation operators, guided by continuously fine-tuned LoRA models trained on Draper data and system discoveries. Implements adaptive sampling to optimize evaluation.

- **Tiered Fitness Evaluation:**  
  Multi-stage pipeline via `FormalSimRunner`:  
  1. Fast heuristics and static checks  
  2. Behavioral RTL simulation  
  3. High-fidelity, radiation-aware GLS and formal verification with SEU fault injection

- **Knowledge Graph:**  
  ArangoDB storing vulnerabilities, exploits, patches, proofs, fitness records, and cryptographic lineage.

- **Autonomous Fine-Tuning:**  
  `AutonomousFineTuner` agent manages data curation and LoRA model updates during low-usage periods.

- **EDA Tool Abstraction Layer:**  
  Python library wrapping EDA tool interactions (simulators, formal tools) and license management.

- **Security & Patching Workflow:**  
  Cryptographic signing (`CryptoProver`), AI-assisted analysis (`SecurityAnalyst`), human review, contextualized patching (`SeniorCoder-HW`), and rad-aware formal patch verification (`Librarian-Formal-Verify`).

- **Radiation Awareness:**  
  Integration of Draper SEU models into exploit evaluation and patch verification.

- **Packaging & Deployment:**  
  Secure on-premises deployment via Docker and `uv`, requiring GPU resources (H100 recommended).

---

# Recovery Plan (If Session Crashes)

1. Review `taskplan.md` for the last completed task `[X]`.
2. Resume at the first incomplete task `[ ]`.
3. Relaunch environment and dependencies (`docker compose up -d`), restart MCP agents.
4. Instruct `Planner` to continue.

---

# Task Plan Visualization

*(See `taskplan.md` for detailed Gantt chart)*

```mermaid
gantt
    dateFormat  YYYY-MM-DD
    title       Exploit Evolver Task Plan (v2.1 - Final)
    excludes    weekends

    section Phase 1: Core Infrastructure (9 Weeks)
    Initialize Project & Dependencies          : done, 2025-04-15, 5d
    Define ArangoDB Schema                    : after P1T1, 4d
    Develop EDA Abstraction Layer             : after P1T1, 7d
    Implement FormalSimRunner Agent           : after P1T3, 7d
    Implement Basic Genetic Mutator           : after P1T2, 7d
    Integrate Basic Loop                      : after P1T4, 6d
    Integrate License Checking                : after P1T3, 3d
    Phase 1 Verification & Demo               : after P1T6, 2d

    section Phase 2: Radiation Hardening (7 Weeks)
    Define SEU Model Strategy                 : after P1T8, 5d
    Implement Rad-Aware Tier 3 Eval           : after P2T1, 7d
    Integrate Draper Rad Data                 : after P2T2, 3d
    Implement Advanced GA Operators           : after P1T8, 7d
    Implement Adaptive Sampling               : after P2T4, 5d
    Create Rad-Aware Tests                    : after P2T5, 4d
    Phase 2 Verification & Demo               : after P2T6, 2d

    section Phase 3: Fine-Tuning & Analysis (8 Weeks)
    Establish Data Curation Pipeline          : after P1T8, 7d
    Implement Autonomous Fine-Tuner           : after P3T1, 7d
    Integrate LoRA in Mutator                 : after P3T2, 5d
    Implement Security Analyst Agent          : after P1T8, 6d
    Implement Human Review Escalation         : after P3T4, 4d
    Create Workflow Tests                     : after P3T5, 5d
    Phase 3 Verification & Demo               : after P3T6, 2d

    section Phase 4: Security & Patching (7 Weeks)
    Implement BLS Signature Generation        : after P1T8, 5d
    Integrate CryptoProver                    : after P4T1, 5d
    Update ArangoDB Schema for Signatures     : after P4T2, 3d
    Implement SeniorCoder Patch Workflow      : after P3T7, 7d
    Implement Librarian Formal Proofs         : after P4T4, 7d
    Phase 4 Verification & Demo               : after P4T5, 2d

    section Phase 5: Final Testing (5 Weeks)
    End-to-End Testing & Tuning               : after P4T6, 10d
    Develop DO-254 Documentation Hooks        : after P5T1, 3d
    Finalize README & User Guides             : after P5T2, 4d
    Refine Fine-Tuning Schedule               : after P5T1, 3d
    Final Demo & Handover                     : after P5T4, 2d
```

---

# Final Notes

- The system leverages **LoRA fine-tuning** to continuously improve GA exploit evolution.
- **BLS signatures** provide compact, verifiable exploit lineage.
- **SEU models** are integrated into both exploit evaluation and patch verification.
- **Human-in-the-loop** oversight ensures safety and compliance.
- Designed for **secure, on-premises deployment** with scalable GPU acceleration.
