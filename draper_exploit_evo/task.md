<img src="../source_materials/www.draper.com/draper_logo.svg" alt="Draper Logo" width="300"/>

<style>
body {
  font-family: "Gotham", sans-serif;
  background-color: #FFFFFF;
  color: #10181F;
}
h1, h2, h3, h4, h5, h6 {
  color: #10181F;
}
a {
  color: #FF4611;
}
blockquote {
  background-color: #F6F4EE;
  color: #10181F;
  padding: 10px 20px;
  border-left: 4px solid #FF4611;
  border-radius: 5px;
}
.mermaid {
  background-color: #FFFFFF !important;
}
</style>

# üéØ Objective: Autonomous Hardware Exploit Evolution System

> **Note:** On-premises deployment significantly aids ITAR compliance by keeping data internal. Full compliance requires additional organizational controls (access restrictions, audits, training, documentation).

---

Develop an MCP-compatible, on-premises agentic R&D system (**draper-mcp-exploit-evolver**) for continuous, adaptive discovery and analysis of vulnerabilities in Draper's radiation-hardened microelectronics. The system automates exploit evolution using advanced genetic algorithms (GAs) guided by LoRA fine-tuning, integrates SEU-aware tiered evaluation, stores findings in a knowledge graph, provides cryptographic lineage proofs, and incorporates human oversight for critical decisions and patching.

---

## üèóÔ∏è Core Components

- **ü§ñ Agentic Workflow (MCP):**  
  Orchestrated by `Boomerang`, coordinating specialized agents:  
  `Planner`, `RTLIntrospector`, `ExploitMutator`, `FormalSimRunner`, `CryptoProver`, `SecurityAnalyst`, `SeniorCoder-HW`, `Librarian-Formal-Verify`, `AutonomousFineTuner`.  
  Includes mandatory human-in-the-loop steps.

- **üß¨ Exploit Mutator Engine:**  
  Advanced GA with hardware-specific mutation operators, guided by continuously fine-tuned LoRA models trained on Draper data and system discoveries. Implements adaptive sampling to optimize evaluation.

- **üìä Tiered Fitness Evaluation:**  
  Multi-stage pipeline via `FormalSimRunner`:  
  1. ‚ö° Fast heuristics and static checks  
  2. üñ•Ô∏è Behavioral RTL simulation  
  3. ‚ò¢Ô∏è High-fidelity, radiation-aware GLS and formal verification with SEU fault injection

- **üóÇÔ∏è Knowledge Graph:**  
  ArangoDB storing vulnerabilities, exploits, patches, proofs, fitness records, and cryptographic lineage.

- **üß† Autonomous Fine-Tuning:**  
  `AutonomousFineTuner` agent manages data curation and LoRA model updates during low-usage periods.

- **üõ†Ô∏è EDA Tool Abstraction Layer:**  
  Python library wrapping EDA tool interactions (simulators, formal tools) and license management.

- **üîí Security & Patching Workflow:**  
  Cryptographic signing (`CryptoProver`), AI-assisted analysis (`SecurityAnalyst`), human review, contextualized patching (`SeniorCoder-HW`), and rad-aware formal patch verification (`Librarian-Formal-Verify`).

- **‚ò¢Ô∏è Radiation Awareness:**  
  Integration of Draper SEU models into exploit evaluation and patch verification.

- **üì¶ Packaging & Deployment:**  
  Secure on-premises deployment via Docker and `uv`, requiring GPU resources (H100 recommended).

---

## üîÑ Recovery Plan (If Session Crashes)

1. üîç Review `taskplan.md` for the last completed task `[X]`.
2. ‚ñ∂Ô∏è Resume at the first incomplete task `[ ]`.
3. üöÄ Relaunch environment and dependencies (`docker compose up -d`), restart MCP agents.
4. üìù Instruct `Planner` to continue.

---

## üìÖ Task Plan Visualization

*(See `taskplan.md` for detailed Gantt chart)*

```mermaid
%%{init: { 'theme': 'base', 'themeVariables': {
  'fontFamily': '"Gotham", "Mulish", sans-serif',
  'primaryColor': '#F6F4EE',
  'primaryTextColor': '#10181F',
  'lineColor': '#10181F',
  'secondaryColor': '#dcdcdc',
  'tertiaryColor': '#555',
  'gantt': {
    'sectionTextColor': '#10181F',
    'taskTextColor': '#10181F',
    'taskBorderColor': '#10181F',
    'taskBkgColor': '#F6F4EE',
    'activeTaskBkgColor': '#dcdcdc',
    'activeTaskBorderColor': '#10181F',
    'doneTaskBkgColor': '#555',
    'doneTaskBorderColor': '#10181F',
    'critTaskBkgColor': '#FF4611',
    'critTaskBorderColor': '#10181F',
    'gridColor': '#dcdcdc'
  }
}}}%%
gantt
    dateFormat  YYYY-MM-DD
    title       Exploit Evolver Task Plan (v2.1 - Final)
    excludes    weekends

    section "Core Infrastructure (9 weeks)"
    Init Project                              :done, P1T1, 2025-04-15, 5d
    ArangoDB Schema                          :active, P1T2, after P1T1, 4d
    EDA Abstraction                          :P1T3, after P1T1, 7d
    FormalSimRunner                          :P1T4, after P1T3, 7d
    Genetic Mutator                          :P1T5, after P1T2, 7d
    Basic Loop                               :P1T6, after P1T4, 6d
    License Check                            :P1T7, after P1T3, 3d
    Phase 1 Demo                             :P1T8, after P1T6, 2d

    section "Radiation Hardening (7 weeks)"
    SEU Strategy                             :P2T1, after P1T8, 5d
    Rad-Aware Eval                          :P2T2, after P2T1, 7d
    Draper Rad Data                         :P2T3, after P2T2, 3d
    Adv GA Operators                        :P2T4, after P1T8, 7d
    Adaptive Sampling                       :P2T5, after P2T4, 5d
    Rad-Aware Tests                         :P2T6, after P2T5, 4d
    Phase 2 Demo                            :P2T7, after P2T6, 2d

    section "Fine-Tuning (8 weeks)"
    Data Pipeline                           :P3T1, after P1T8, 7d
    Fine-Tuner                              :P3T2, after P3T1, 7d
    LoRA in Mutator                        :P3T3, after P3T2, 5d
    Security Analyst                        :P3T4, after P1T8, 6d
    Review Escalation                       :P3T5, after P3T4, 4d
    Workflow Tests                          :P3T6, after P3T5, 5d
    Phase 3 Demo                            :P3T7, after P3T6, 2d

    section "Security Integration (7 weeks)"
    BLS Signatures                          :P4T1, after P1T8, 5d
    CryptoProver                            :P4T2, after P4T1, 5d
    Update Schema                           :P4T3, after P4T2, 3d
    Patch Workflow                          :P4T4, after P3T7, 7d
    Formal Proofs                           :P4T5, after P4T4, 7d
    Phase 4 Demo                            :P4T6, after P4T5, 2d

    section "Final Testing (5 weeks)"
    E2E Testing                             :P5T1, after P4T6, 10d
    DO-254 Docs                             :P5T2, after P5T1, 3d
    Finalize Docs                           :P5T3, after P5T2, 4d
    Refine Schedule                         :P5T4, after P5T1, 3d
    Demo & Handover                        :P5T5, after P5T4, 2d
```

---

## üìù Final Notes

- üîÑ The system leverages **LoRA fine-tuning** to continuously improve GA exploit evolution.
- üîê **BLS signatures** provide compact, verifiable exploit lineage.
- ‚ò¢Ô∏è **SEU models** are integrated into both exploit evaluation and patch verification.
- üë• **Human-in-the-loop** oversight ensures safety and compliance.
- üè¢ Designed for **secure, on-premises deployment** with scalable GPU acceleration.

---

## üîí Security Implementation Checklist

### Access Control
- Enforce strict RBAC and ABAC policies for all agents, developers, and reviewers.
- Remove or disable all default accounts in ArangoDB, Docker, and internal services.
- Prohibit shared credentials; assign unique, auditable identities to each user and agent.
- Segment exploit data, cryptographic keys, and credentials into isolated database schemas.
- Continuously audit access logs and monitor for anomalous activities.

### Key Management
- Store BLS keys and secrets in HSMs or secure vaults.
- Automate key rotation schedules.
- Restrict key access to CryptoProver and authorized admins only.
- Separate key management duties from exploit development roles.
- Log all key lifecycle events.

### Audit Trails
- Centralize encrypted, immutable logs of agent actions, exploit mutations, signing, and reviews.
- Include timestamps, user/agent IDs, and event types.
- Enable alerts on suspicious activities.
- Require MFA or certificates for log access.
- Review logs regularly.

### Insider Threats
- Use behavioral analytics to detect anomalous user/agent behavior.
- Enforce least privilege across all roles.
- Conduct insider threat training.
- Perform periodic risk assessments.
- Establish an insider threat response team.

### Recovery Plan Security
- Protect backups and recovery images with cryptographic checksums.
- Require MFA for recovery operations.
- Isolate recovery infrastructure from operational networks.
- Test recovery procedures regularly.
- Log all recovery actions.

### Social Engineering Defense
- Maintain incident response playbooks for phishing and impersonation.
- Conduct phishing simulations.
- Implement email filtering, URL inspection, and attachment sandboxing.
- Use social engineering testing tools.
- Integrate social engineering defense into training.
